<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function($scope,$http,snRecordWatcher,$rootScope) {
/*widget controller */
var c = this;
c.data.loading = true;
c.data.table = c.options.table || "incident";
c.data.query = c.options.query || "";
c.data.template = c.options.template || "task-category";
function getData(){
$http.get('/api/now/table/'+c.data.table+'?sysparm_query='+c.data.query).success(
function(response){
c.data.loading=false;
c.data.list = response.result;
$rootScope.$broadcast("DD18ListWidgetUpdated",c.data.list);
})
}
getData();
snRecordWatcher.initList(c.data.table, c.data.query);
$scope.$on('record.updated', function(name, data) {
getData();
});
}

]]></client_script>
        <controller_as>c</controller_as>
        <css/>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list>title,color</field_list>
        <has_preview>false</has_preview>
        <id>dd18-list-widget</id>
        <internal>false</internal>
        <link/>
        <name>dd18_list_widget</name>
        <option_schema>[{"name":"table","section":"other","default_value":"incident","label":"Table","type":"string"},{"name":"query","section":"other","label":"Query","type":"string"},{"name":"template","section":"other","label":"Template","type":"string"}]</option_schema>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function() {
/*populate the 'data' object */
/*e.g., data.table = $sp.getValue('table'); */
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2018-03-21 15:55:28</sys_created_on>
        <sys_id>9989d6e84f411300a071ff6f9310c75f</sys_id>
        <sys_mod_count>11</sys_mod_count>
        <sys_name>dd18_list_widget</sys_name>
        <sys_package display_value="Polls" source="x_snc_polls">cd1f2766133e1200ed373d62f244b082</sys_package>
        <sys_policy/>
        <sys_scope display_value="Polls">cd1f2766133e1200ed373d62f244b082</sys_scope>
        <sys_update_name>sp_widget_9989d6e84f411300a071ff6f9310c75f</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-03-21 17:04:20</sys_updated_on>
        <template><![CDATA[<div class="panel panel-default">
<!-- your widget template -->
<div class="panel-heading">
DD18 List Widget
</div>
<div class="panel-body">
  <ul class="list-group">
<li class="list-group-item" ng-repeat="item in
c.data.list">{{item.number}} - {{item.short_description}} -
{{item.priority}}</li>
</ul>
</div>
</div>]]></template>
    </sp_widget>
</record_update>
